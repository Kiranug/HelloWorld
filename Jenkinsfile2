@Library('jenkins-shared-library-framework@master') _ //master or whatever branch

def call() {
  Map pipelineConfig = readYaml(file: "${WORKSPACE}/pipeline.yaml")
  return pipelineConfig
}
pipeline {
    agent any  
    environment {
        // initialize common vars
        common_vars = staging.loadVars()
        } // environment

    stages {
        stage('Some Stage') {
           steps {
                echo "${env.common_vars}"
              
            }
        }
        
               def p = pipelineConfig()

        stage('Prerequistes'){
            serviceName = sh (
                    script: "echo ${p.SERVICE_NAME}|cut -d '-' -f 1",
                    returnStdout: true
                ).trim()
        }
    }

    post {
        always { 
            script {
                // Print environment variables
                sh "env"
            } // script
        } // always
    } // post

} // pipeline
